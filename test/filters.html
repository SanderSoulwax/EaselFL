<!-- Renders bitmaps drawn using various methods -->

<html>
<head>

<script type="text/javascript" src="js/TestUtils.js"></script>

<link rel='stylesheet' type='text/css' href='css/test.css' />

<script type="text/javascript">

window.onload = function(){
	if(TestUtils.useCanvas){
		TestUtils.loadWithEaselJS(init);
	}else{
		TestUtils.loadWithEaselFL(init);
	}
}

//-- Start it up!

function init(){
	var canvas = document.createElement('canvas');
	canvas.setAttribute('width', 600);
	canvas.setAttribute('height', 400);
	canvas.setAttribute('fl_swf_url', '../haxe/bin/EaselFl.swf');
	canvas.setAttribute('id', 'testContainer');
	document.getElementById('testContainer').appendChild(canvas);
	
	var myStage = new Stage(canvas);
	Ticker.addListener(myStage);
	
	//-- specific test code
	var img = new Image();
	img.src = 'img/testImage.png';
	
	
	//-- shadow
	var obj, g;
	/*shp = new Shape();
	shp.x = 300;
	shp.y = 200;
	g = shp.graphics;
	g.beginBitmapFill(img);
	g.drawCircle(0, 0, 100);
	g.endFill();
	
	myStage.addChild(shp);*/
	
	
	
	//-- color matrix
	var bmp = new Bitmap(img);
	bmp.filters = [new ColorMatrixFilter(new ColorMatrix(0, 0, 0, 0))];
	bmp.cache(-100, -100, 200, 200);
	bmp.x = 300;
	bmp.y = 200;
	myStage.addChild(bmp);
	
	//-- shadow
	var shp = new Shape();
	shp.graphics.beginFill('#FFF');
	shp.graphics.drawCircle(0, 0, 50);
	shp.graphics.endFill();
	shp.x = 200;
	shp.y = 230;
	shp.shadow = new Shadow('#2895AE', 0, 0, 8);
	myStage.addChild(shp);
	
	//-- animate
	var seed = 0;
	
	setInterval(function(){
		bmp.filters[0].matrix.adjustHue(10);
		bmp.updateCache();
		shp.shadow.blur = (1 + Math.sin( seed+=0.4 )) * 8;
	}, 250);	
}

</script>
</head>
<body>
</body>
</html>